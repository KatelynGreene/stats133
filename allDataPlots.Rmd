---
title: "All Plots"
author: ""
date: ""
output:  
  html_document:
    fig_height: 3
    fig_width: 5
---
<!-- Don't edit in between this line and the one below -->
```{r include=FALSE}
# Don't delete this chunk if you are using the DataComputing package
library(DataComputing)
```
*Source file* 
```{r, results='asis', echo=FALSE}
includeSourceDocuments() 
```
<!-- Don't edit the material above this line -->

Run CleanAndJoinData.RMD first to ensure all_data data frame is in your local environment.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Scatterplots
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```{r eval = FALSE}

#' Graphs the percentage of people with a bachelors vs. TreeCanopy and faceted by IncomeQuartile
#'
#' @return edu_treecanop_plot

edu_treecanop_plot<-all_data%>%
  ggplot(aes(x=TreeCanopyCover, y=Bachelors))+
  geom_point(aes(color=IncomeQuartile))+
  facet_grid(.~IncomeQuartile)

edu_treecanop_plot

```

```{r eval = FALSE}
#use ggplot to plot edication data versus income data
#edu_inc_plot<-all_dataw%>%
  #ggplot(aes(x=PercentOfAdults, y=Income))+
  #geom_point(aes(color=EducationLevel))+
  #facet_grid(EducationLevel~.)
#View(all_data_narrow)
#edu_inc_plot
```

```{r eval = FALSE}
#Linear Regerssion Time......
library(statisticalModeling)
library(rpart)
#install.packages("rpart.plot")
library(rpart.plot)
library(stats)
library(mosaicData)

#Tree reg
et1<-lm(Bachelors~TreeCanopyCover, data=all_data)
et2<-lm(Bachelors~TreeCanopyCover + UrbanRank, data=all_data)
et3<-lm(Bachelors~TreeCanopyCover + UrbanRank +Income, data=all_data)
stargazer::stargazer(et1, et2, et3, type="text",
 dep.var.labels=c("Percent of Adults with Bachelor's Deegree"),
 covariate.labels=c("Tree Canopy Cover","Urban Rank", "Median Income"), out="tree_edu.txt")

#pollution regressions


ep1<-lm(Bachelors~Pollution, data=all_data) 
ep2<-lm(Bachelors~Pollution + UrbanRank, data=all_data)
ep3<-lm(Bachelors~Pollution + UrbanRank + Income, data=all_data) 

stargazer::stargazer(ep1, ep2, type="text",
 dep.var.labels=c("Percent of Adults with Bachelor's Deegree"),
 covariate.labels=c("Particulate Matter","Urban Rank", "Median Income"), out="polution_edu.txt")
```

## Boxplots for air pollution, arsenic, and tree cover (Kana)
```{r}
load("all_data.RData")
#head(all_data)

bach_vs_pollution_lm <- all_data %>%
  na.omit() %>%
  ggplot(aes(Pollution, Bachelors)) +
  geom_point(aes(color = UrbanRank), alpha = 0.3, size = 2) +
   scale_color_manual(values = c("#6baed6","#4292c6","#2171b5")) +
  geom_smooth(method = "lm") +
  facet_grid(~ UrbanRank) +
  labs(x="Concentration of PM 2.5 (ug/m^3)", y="% Adults with Bachelor's Degrees") +
  theme_bw()

bach_vs_pollution_lm

bach_vs_tree_lm <- all_data %>% 
  na.omit() %>%
  ggplot(aes(TreeCanopyCover, Bachelors)) +
  geom_point(aes(color = UrbanRank), alpha = 0.3, size = 2) +
  scale_color_manual(values = c("#6baed6","#4292c6","#2171b5")) +
  geom_smooth(method = "lm") +
  facet_grid(. ~ UrbanRank) +
  labs(x="% Tree Canopy Cover", y="% Adults with Bachelor's Degrees") +
  theme_bw() 

bach_vs_tree_lm 

bach_vs_pollution_lm_income <- all_data %>%
  na.omit() %>%
  ggplot(aes(Pollution, Bachelors)) +
  geom_point(aes(color = IncomeQuartile), alpha = 0.3, size = 2) +
  geom_smooth(method = "lm") +
  facet_grid(~ IncomeQuartile) +
  labs(x="Concentration of PM 2.5 (ug/m^3)", y="% Adults with Bachelor's Degrees") +
  theme_bw()

bach_vs_pollution_lm_income

 
bach_vs_tree_lm_income <- all_data %>% 
  na.omit() %>%
  ggplot(aes(TreeCanopyCover, Bachelors)) +
  geom_point(aes(color = IncomeQuartile), alpha = 0.3, size = 2) +
 # scale_color_manual(values = c("#6baed6","#4292c6","#2171b5")) +
  geom_smooth(method = "lm") +
  facet_grid(. ~ IncomeQuartile) +
  labs(x="% Tree Canopy Cover", y="% Adults with Bachelor's Degrees") +
  theme_bw() 

bach_vs_tree_lm_income
#Used in the blox plot 
#all_data_UrbanRank <- all_data %>% 
#  select(UrbanRank, LessThanHS, HSDiploma, SomeCollege, Bachelors) %>%
#  gather(key= Education, value = Percent, `LessThanHS`, `HSDiploma`, `SomeCollege`, `Bachelors`) %>%
#  group_by(UrbanRank, Education) %>%
#  summarise(average = mean(Percent))

#Makes useless stacked bar plot
#all_data_UrbanRank %>% ggplot( aes(x = UrbanRank, y = average, fill = Education)) + 
#    geom_bar(stat = "identity")

```

```{r}

SW_bach_vs_pollution_lm <- all_data %>%
  na.omit() %>%
  filter(Region == "South") %>%
  ggplot(aes(Pollution, Bachelors)) +
  geom_point(aes(color = UrbanRank), alpha = 0.3, size = 2) +
   scale_color_manual(values = c("#6baed6","#4292c6","#2171b5")) +
  geom_smooth(method = "lm") +
  facet_grid(~ UrbanRank) +
  labs(x="Concentration of PM 2.5 (ug/m^3)", y="% Adults with Bachelor's Degrees") +
  ggtitle("South")+
  theme_bw()

SW_bach_vs_pollution_lm

W_bach_vs_pollution_lm <- all_data %>%
  na.omit() %>%
  filter(Region == "West") %>%
  ggplot(aes(Pollution, Bachelors)) +
  geom_point(aes(color = UrbanRank), alpha = 0.3, size = 2) +
   scale_color_manual(values = c("#6baed6","#4292c6","#2171b5")) +
  geom_smooth(method = "lm") +
  facet_grid(~ UrbanRank) +
  labs(x="Concentration of PM 2.5 (ug/m^3)", y="% Adults with Bachelor's Degrees") +
  ggtitle("West")+
  theme_bw()

W_bach_vs_pollution_lm

SE_bach_vs_pollution_lm <- all_data %>%
  na.omit() %>%
  filter(Region == "NorthEast") %>%
  ggplot(aes(Pollution, Bachelors)) +
  geom_point(aes(color = UrbanRank), alpha = 0.3, size = 2) +
   scale_color_manual(values = c("#6baed6","#4292c6","#2171b5")) +
  geom_smooth(method = "lm") +
  facet_grid(~ UrbanRank) +
  labs(x="Concentration of PM 2.5 (ug/m^3)", y="% Adults with Bachelor's Degrees") +
  ggtitle("NorthEast")+
  theme_bw()

SE_bach_vs_pollution_lm

MW_bach_vs_pollution_lm <- all_data %>%
  na.omit() %>%
  filter(Region == "MidWest") %>%
  ggplot(aes(Pollution, Bachelors)) +
  geom_point(aes(color = UrbanRank), alpha = 0.3, size = 2) +
   scale_color_manual(values = c("#6baed6","#4292c6","#2171b5")) +
  geom_smooth(method = "lm") +
  facet_grid(~ UrbanRank) +
  labs(x="Concentration of PM 2.5 (ug/m^3)", y="% Adults with Bachelor's Degrees") +
  ggtitle("MidWest")+
  theme_bw()

MW_bach_vs_pollution_lm

all_bach_vs_pollution_lm <- all_data %>%
  na.omit() %>%
  ggplot(aes(Pollution, Bachelors))+
  geom_point(aes(color = UrbanRank))+
  geom_smooth(method = "lm")+
  facet_grid(UrbanRank~Region)

all_bach_vs_pollution_lm

#all_bach_vs_pollution_lm2 <- all_data %>%
#  na.omit() %>%
#  ggplot(aes(Pollution, Bachelors))+
#  geom_point(aes(color = UrbanRank))+
 # geom_smooth(method = "lm")+
#  facet_grid(~Region)

#all_bach_vs_pollution_lm2


```
```{r}


W_bach_vs_tree_lm <- all_data %>%
  na.omit() %>%
  filter(Region == "West") %>%
  ggplot(aes(TreeCanopyCover, Bachelors)) +
  geom_point(aes(color = UrbanRank), alpha = 0.3, size = 2) +
   scale_color_manual(values = c("#6baed6","#4292c6","#2171b5")) +
  geom_smooth(method = "lm") +
  facet_grid(~ UrbanRank) +
  labs(x="% Tree Canopy Cover", y="% Adults with Bachelor's Degrees") +
  ggtitle("West")+
  theme_bw()

W_bach_vs_tree_lm

SE_bach_vs_tree_lm <- all_data %>%
  na.omit() %>%
  filter(Region == "South") %>%
  ggplot(aes(TreeCanopyCover, Bachelors)) +
  geom_point(aes(color = UrbanRank), alpha = 0.3, size = 2) +
   scale_color_manual(values = c("#6baed6","#4292c6","#2171b5")) +
  geom_smooth(method = "lm") +
  facet_grid(~ UrbanRank) +
  labs(x="% Tree Canopy Cover", y="% Adults with Bachelor's Degrees") +
  ggtitle("South")+
  theme_bw()

SE_bach_vs_tree_lm

MW_bach_vs_tree_lm <- all_data %>%
  na.omit() %>%
  filter(Region == "MidWest") %>%
  ggplot(aes(TreeCanopyCover, Bachelors)) +
  geom_point(aes(color = UrbanRank), alpha = 0.3, size = 2) +
   scale_color_manual(values = c("#6baed6","#4292c6","#2171b5")) +
  geom_smooth(method = "lm") +
  facet_grid(~ UrbanRank) +
  labs(x="% Tree Canopy Cover", y="% Adults with Bachelor's Degrees") +
  ggtitle("MidWest")+
  theme_bw()

MW_bach_vs_tree_lm

NE_bach_vs_tree_lm <- all_data %>%
  na.omit() %>%
  filter(Region == "NorthEast") %>%
  ggplot(aes(TreeCanopyCover, Bachelors)) +
  geom_point(aes(color = UrbanRank), alpha = 0.3, size = 2) +
   scale_color_manual(values = c("#6baed6","#4292c6","#2171b5")) +
  geom_smooth(method = "lm") +
  facet_grid(~ UrbanRank) +
  labs(x="% Tree Canopy Cover", y="% Adults with Bachelor's Degrees") +
 ggtitle("NorthEast")+
  theme_bw()

NE_bach_vs_tree_lm

all_bach_vs_tree_lm <- all_data %>%
  na.omit() %>%
  ggplot(aes(TreeCanopyCover, Bachelors))+
  geom_point(aes(color = UrbanRank))+
  geom_smooth(method = "lm")+
  facet_grid(UrbanRank~Region)

all_bach_vs_tree_lm
```

